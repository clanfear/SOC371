---
output:
  github_document:
    html_preview: true
---

```{r, include=FALSE}
library(tidyverse)
library(pander)
```

# SOC 371
## Criminology
### University of Washington

## Important links

* [Canvas Page (enrolled students only)](null)
* [Syllabus](docs/syllabus.html)
* [Discussion Question Instructions](null)
* [Essay Instructions](docs/essay.html) and grading rubric.
* [Class Mailing List](null)

## Course Material

```{r, echo=FALSE, message=FALSE, warning=FALSE}
course_outline <- readxl::read_excel("./ignore/course_workbook.xlsx", sheet=1) %>% filter(Ignore!=1)
course_readings <- readxl::read_excel("./ignore/course_workbook.xlsx", sheet=2) %>% filter(Ignore!=1) %>%
  select(Lecture, Citation)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE, eval=FALSE}
course_outline %>%
  select(Week, Lecture, Date, Topic) %>%
  filter(!is.na(Lecture)) %>%
  left_join(course_readings, by = "Lecture") %>%
  select(-Lecture, Readings = Citation) %>%
  group_by(Date) %>%
  summarize(Topic = first(Topic), Readings = paste(Readings, collapse = "<br><br>")) %>%
  mutate(Readings = ifelse(Readings == "NA", NA_character_, Readings)) %>%
  mutate_at(vars(-Date), ~ ifelse(is.na(.), "", .)) %>%
  arrange(Date) %>%
  mutate(Date = format(Date, "%b %e")) %>%
  pander()
```

```{r, echo=FALSE}
course_outline %>%
  select(Week, Lecture, Date, Topic) %>%
  filter(!is.na(Lecture)) %>%
  left_join(course_readings, by = "Lecture") %>%
  select(-Lecture, Readings = Citation) %>%
  group_by(Date) %>%
  mutate(reading_number = as.character(row_number())) %>%
  mutate(reading_number = ifelse(!is.na(lead(reading_number)) | !is.na(lag(reading_number)), paste0("(",reading_number,") "), "")) %>%
  summarize(Topic = first(Topic), Readings = paste(paste0(reading_number, Readings), collapse = "<br><br>")) %>%
  mutate(Readings = ifelse(str_detect(Readings, "NA"), "No assigned reading", Readings)) %>%
  mutate_at(vars(-Date), ~ ifelse(is.na(.), "", .)) %>%
  mutate(Topic = case_when(
    is.na(lag(Topic)) ~ Topic,
    lag(Topic) == Topic ~ paste0(Topic, " 2"),
    lead(Topic) == Topic ~ paste0(Topic, " 1"),
    TRUE ~ Topic
  )) %>%
  arrange(Date) %>%
  mutate(Date = format(Date, "%b %e")) %>%
  mutate(`Topic and Readings` = paste0("**",Topic,"**", "<br>", Readings)) %>%
  select(Date, `Topic and Readings`) %>%
  pander()
```
